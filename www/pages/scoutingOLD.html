<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <link rel="stylesheet" href="../css/index.css">
        <link rel="stylesheet" href="../css/bootstrap.css">

        <title>Scout Page</title>
    </head>
    <body onload="populate()">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                    <button type="button" id="rdbtn" class="navbar-toggle btn" data-toggle="modal" data-target="#disabledRobot">
                        Robot Disabled
                    </button>
                <p class="navbar-text" id="navscouting">Scouting:</p>
                <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#disabledRobot" style="margin-top: 6px;" id="rdbtn">Robot Disabled</button>
                </ul>
                </div>
            </div>
        </nav>
        <div class="container">
            <div id="orient">
                <h1>Quick Orientation:</h1>
                <div class="row">
                    <div class="col-xs-8">
                        <h4 id="youare">You are:</h4>
                        <h4 id="scouting">You are scouting team:</h4>
                        <h4 id="bet">You bet on:</h4>
                    </div>
                    <div class="col-xs-4">
                        <button type="button" class="btn btn-warning btn-lg" data-toggle="modal" data-target="#missingRobot">Missing Robot!</button>
                    </div>
                </div>
                <div class="text-center container row">
                    <div class="col-xs-3">
                        <div class="row">
                            <h2>A</h2>
                        </div>
                        <div class="row">
                            <div class="btn-group btn-group-vertical" data-toggle="buttons" id="aD">
                                <label class="btn btn-success"><input type="radio" class="toggle" value="portcullis">Portcullis</label>
                                <label class="btn btn-success"><input type="radio" class="toggle" value="cheval de frise">Cheval de Frise</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div class="row">
                            <h2>B</h1>
                        </div>
                        <div class="row">
                            <div class="btn-group btn-group-vertical" data-toggle="buttons" id="bD">
                                <label class="btn btn-success"><input type="radio" class="toggle" value="moat">Moat</label>
                                <label class="btn btn-success"><input type="radio" class="toggle" value="ramparts">Ramparts</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div class="row">
                            <h2>C</h1>
                        </div>
                        <div class="row">
                            <div class="btn-group btn-group-vertical" data-toggle="buttons" id="cD">
                                <label class="btn btn-success"><input type="radio" class="toggle" value="drawbridge">Drawbridge</label>
                                <label class="btn btn-success"><input type="radio" class="toggle" value="sally port">Sally Port</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div class="row">
                            <h2>D</h1>
                        </div>
                        <div class="row">
                            <div class="btn-group btn-group-vertical" data-toggle="buttons" id="dD">
                                <label class="btn btn-success"><input type="radio" class="toggle" value="rock wall">Rock Wall</label>
                                <label class="btn btn-success"><input type="radio" class="toggle" value="rough terrain">Rough Terrain</label>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <button type="button" class="btn btn-primary btn-block btn-lg" onclick="startMatch()">Start Match</button>
            </div>
            <div id="autoBox">
                <h1>Autonomous</h1>
                <div id="robotStarting" class="row">
                    <div class="col-xs-6">
                        <h4>Robot is starting...</h4>
                    </div>
                    <div class="col-xs-6">
                        <div class="dropdown">
                            <button class="btn btn-default dropdown-toggle" type="button" id="rstart" data-toggle="dropdown">choose location <span class="caret"></span></button>
                            <ul id="autoStartDDL" class="dropdown-menu"></ul>
                        </div>
                    </div>
                </div>
                <hr>
                <div id="robotInteraction" class="row">
                    <div class="col-xs-3">
                        <h4>Interacted with... </h4>
                    </div>
                    <div class="col-xs-5">
                        <div class="row">
                            <div class="col-xs-8">
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle" type="button" id="rinter" data-toggle="dropdown">choose defense <span class="caret"></span></button>
                                    <ul id="dInterDDL" class="dropdown-menu"></ul>
                                </div>
                            </div>
                            <div class="col-xs-4">
                                <h4>by...</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-4">
                        <div class="dropdown">
                            <button class="btn btn-default dropdown-toggle" type="button" id="rby" data-toggle="dropdown">choose action <span class="caret"></span></button>
                            <ul id="dByDDL" class="dropdown-menu"></ul>
                        </div>
                    </div>
                </div>
                <hr>
                <div id="robotScore" class="row">
                    <div class="col-xs-3">
                        <h4>Scored in... </h4>
                    </div>
                    <div class="col-xs-5">
                        <div class="btn-group btn-group-justified" data-toggle="buttons" id="autoscore">
                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="low">low</label>
                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="high">high</label>
                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="no">no</label>
                        </div>
                    </div>
                    <div class="col-xs-4">
                        <h4>goal.</h4>
                    </div>
                </div>
                <br>
                <button type="button" class="btn btn-primary btn-block btn-lg" onclick="startTele()">Start Teleop</button>
            </div>
            <div id="teleBox">
                <h1>Teleop</h1>
                <div class="row" id="shotBox">
                    <div class="row">
                        <div class="col-xs-10"></div>
                        <div class="col-xs-2">
                            <a class="btn btn-default btn-sm" href="#teleBox">Edit</a>
                        </div>
                    </div>
                    <div class="row" id="shotView">
                        <ul id="shotList"></ul>
                    </div>
                    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#addShot"><span class="glyphicon glyphicon-plus"></span> Add a shot...</button>
                </div>
                <br>
                <div class="row">
                    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#addDC"><span class="glyphicon glyphicon-plus"></span> Add a defense crossing...</button>
                    <div class="col-xs-2">
                        <a class="btn btn-default btn-sm" href="#teleBox">Edit</a>
                    </div>
                </div>
            </div>
        </div>
        <div id="modalkeeper">
            <div id="disabledRobot" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">How did the robot get disabled?</h4>
                        </div>
                        <div class="modal-body">
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="tipped">It tipped, and now it's just laying there watching other able-bodied robots fly by.</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="broken">It broke somehow.</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="noshow">It never actually showed up but I hit "Start Match" too early.</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="noshow">It's a mystery! One second it was going and the next it wasn't going anymore...</label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal" onclick="disabledRobot()">OK</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="missingRobot" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">My robot is missing because...</h4>
                        </div>
                        <div class="modal-body">
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="wrongmatch">it's not even supposed to be in this match...</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="broken">it's broken.</label>
                            </div>
                            <div class="radio">
                                <label><input type="radio" name="missingRobot" class="toggle" value="noshow">it never even showed up!</label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal" onclick="missingRobot()">OK</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="setMatchNumber" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Manual Match Choice</h4>
                        </div>
                        <div class="modal-body">
                            <div class="dropdown">
                                <button class="btn btn-default dropdown-toggle" type="button" id="dLabel" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Choose match number...<span class="caret"></span></button>
                                <ul class="dropdown-menu" aria-labelledby="dLabel">
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">1</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">2</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">3</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">4</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">5</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">6</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">7</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">8</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">9</a></li>
                                    <li><a href="#" onclick="document.getElementById('dLabel').innerHTML = this.innerHTML">10</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal" onclick="resetMatchNumber()">OK</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="addShot" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Add a shot</h4>
                        </div>
                        <div class="modal-body">
                            <div class="container text-center">
                                <div class="row">
                                    <p>Future courtyard map!</p>
                                </div>
                                <div class="row">
                                    <div class="col-xs-6">
                                        <div class="btn-group" data-toggle="buttons" id="teleGoalType">
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="low">low</label>
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="high">high</label>
                                        </div>
                                    </div>
                                    <div class="col-xs-6">
                                        <div class="btn-group" data-toggle="buttons" id="teleGoalSuccess">
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="successfully">success</label>
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="unsuccessfully">failure</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="addDC" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Add defense crossing</h4>
                        </div>
                        <div class="modal-body">
                            <div class="container">
                                <div class="row">
                                    <div class="col-xs-6">
                                        <ol id="crossableDefenses" type="A"></ol>
                                    </div>
                                    <div class="col-xs-6">
                                        <div class="btn-group btn-group-vertical" data-toggle="buttons" id="teleGoalSuccess">
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="slowly.">slow</label>
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="with average speed.">average</label>
                                            <label class="btn btn-lg btn-success"><input type="radio" class="toggle" value="quickly.">fast</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="modalmodal" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">TITLE</h4>
                        </div>
                        <div class="modal-body">
                            
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="cordova.js"></script>
        <script src="../js/jquery-2.2.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script src="../js/index.js"></script>
        <script src="../js/Sortable.min.js"></script>
        <script type="text/javascript">
            persist = JSON.parse(window.name);

            function startMatch() {
                document.getElementById("rdbtn").style.visibility = "visible";
                document.getElementById("autoBox").style.visibility = "visible";
                document.getElementById("orient").style.visibility = "hidden";

                aD = $('#aD label.active input').val();
                bD = $('#bD label.active input').val();
                cD = $('#cD label.active input').val();
                dD = $('#dD label.active input').val();

                console.log(aD);

                ul = document.getElementById("autoStartDDL");
                ul.appendChild(makeDDLI("in the spy box.", "rstart"));
                ul.appendChild(makeDDLI("by the " + aD + ".", "rstart"));
                ul.appendChild(makeDDLI("by the " + bD + ".", "rstart"));
                ul.appendChild(makeDDLI("by the " + cD + ".", "rstart"));
                ul.appendChild(makeDDLI("by the " + dD + ".", "rstart"));

                ul = document.getElementById("dInterDDL");
                ul.appendChild(makeDDLI("no defenses", "rinter"));
                ul.appendChild(makeDDLI("the " + aD, "rinter"));
                ul.appendChild(makeDDLI("the " + bD, "rinter"));
                ul.appendChild(makeDDLI("the " + cD, "rinter"));
                ul.appendChild(makeDDLI("the " + dD, "rinter"));

                ul = document.getElementById("dByDDL");
                ul.appendChild(makeDDLI("doing nothing.", "rby"));
                ul.appendChild(makeDDLI("crossing.", "rby"));
                ul.appendChild(makeDDLI("getting there.", "rby"));

                ol = document.getElementById("crossableDefenses");
                ol.appendChild(makeOLI(aD));
                ol.appendChild(makeOLI(bD));
                ol.appendChild(makeOLI(cD));
                ol.appendChild(makeOLI(dD));
            }

            function makeDDLI(text, overID) {
                a = document.createElement("a");
                a.setAttribute("href", "#" + overID);
                a.setAttribute("onclick", "document.getElementById('" + overID + "').innerHTML = this.innerHTML;");
                a.innerHTML = text;

                li = document.createElement("li");
                li.appendChild(a);

                return li;
            }

            function makeOLI(text) {
                li = document.createElement("li");
                li.innerHTML = text;

                return li;
            }

            function startTele() {
                document.getElementById("teleBox").style.visibility = "visible";
                document.getElementById("autoBox").style.visibility = "hidden";

            }

            function populate() {
                document.getElementById("rdbtn").style.visibility = "hidden";
                document.getElementById("autoBox").style.visibility = "hidden";
                document.getElementById("teleBox").style.visibility = "hidden";

                document.getElementById("youare").innerHTML = "You are: " + persist.user.name + " <small><a href='#' onclick='matchMinus()'>Not You?</a></small>";
                document.getElementById("scouting").innerHTML = "You are scouting team: " + persist.match.robot;
                document.getElementById("navscouting").innerHTML = "Scouting: " + persist.match.robot + " in match " + persist.match.number;
                document.getElementById("bet").innerHTML = "You bet on: " + persist.user.lastbet;

                Sortable.create(document.getElementById("shotList"));
            }

            function missingRobot() {
                var reason = $('input[name="missingRobot"]:checked').val();
                
                if (reason === "wrongmatch") {
                    $('#setMatchNumber').modal('toggle')
                } else if (reason === "broken" || reason === "noshow") {
                    persist.spec.matches[persist.spec.matches.length - 1].misc.brokenDown = true;
                    sendOff(persist.spec);
                    window.location.href = "thanks.html";
                }
            }

            function disabledRobot() {
                persist.spec.matches[persist.spec.matches.length - 1].misc.brokenDown = true;
                sendOff(persist.spec);
                window.location.href = "thanks.html";
            }

            function resetMatchNumber() {
                n = document.getElementById('dLabel').innerHTML;
                persist.match.number = n;
                window.name = JSON.stringify(persist);
                window.location.href = "scouting.html";
            }

            function matchMinus() {
                n = parseInt(persist.match.number);
                persist.match.number = String(n - 1);
                console.log(persist.match);
                window.name = JSON.stringify(persist);
                window.location.href = "login.html";
            }
        </script>
        <style type="text/css"> 
            body { padding-top: 70px; }
        </style>
    </body>
</html>
